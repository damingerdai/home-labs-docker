version: "3"
services:
  gitea:
    image: gitea/gitea:1.21.3
    container_name: gitea
    environment:
      - USER_UID=1000
      - USER_GID=1000
      - GITEA__database__DB_TYPE=postgres
      - GITEA__database__HOST=host.docker.internal:5432
      - GITEA__database__NAME=gitea
      - GITEA__database__USER=gitea
      - GITEA__database__PASSWD=gitea
      - APP_NAME=大明二代的gitea
      - SSH_PORT=1022
      - SSH_LISTEN_PORT=1022
    restart: always
    networks:
      - gitea
    volumes:
       - ./data:/data
       - /etc/timezone:/etc/timezone:ro
       - /etc/localtime:/etc/localtime:ro
    ports:
       - "13000:3000"
       - "1022:1022"
    extra_hosts:
      - host.docker.internal:host-gateway
networks:
  gitea:
    external: false
